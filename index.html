<html>
<head>
    <meta charset="UTF-8">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <title>Document</title>
</head>
<body>
    <div class="container">
        <h2>Introduction to firebase</h2>
        <input name="type" type="text" class="form-control" placeholder="Type in here">
        <a href="#" id="type" class="btn btn-primary">Submit</a>
        <ul class="list-group">
        </ul>
        <input name="name" type="text" class="form-control" placeholder="Name in here">
        <input name="age" type="text" class="form-control" placeholder="Age in here">
        <input name="salary" type="text" class="form-control" placeholder="Salary in here">
        <br/>
        <div class="form-inline">
            <a id="push" href="#" class="btn btn-primary">Push</a>
            <a id="set" href="#" class="btn btn-warning">Set</a>
            <a id="delete" href="#" class="btn btn-danger">Delete</a>
        </div>
    </div>

    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/firebase.js"></script>
    <script>
        $(function() {
            var input = $('input[name="type"]');
            var button = $('#type');
            var ul = $('ul');
            var config = {
                databaseURL: "https://fir-tutorial-4a204.firebaseio.com/"
            };
            firebase.initializeApp(config);
            var commentsRef = firebase.database().ref('/').child('comments');
            var customersRef = firebase.database().ref('/').child('customers');
            listenToFirebase();

            button.click(function() {
                var text = input.val();
                commentsRef.push(text);
                input.val('');
            });

            function addToList(text) {
                var li = '<li class="list-group-item" >' + text + '</li>';
                ul.append(li);
            }

            function listenToFirebase() {
                commentsRef.on('value', function(snapshot) {
                    var comments = snapshot.val();
                    var i = 1;

                    ul.empty();
                    if( comments != null ) {
                        $.each(comments, function(index, c) { 
                            addToList(parseInt(i) + ': ' + c);
                            i++;
                        })
                    }
                });
            }

            $('#push').on('click', function() {
                var name = $('input[name = "name"]').val();
                var age = $('input[name = "age"]').val();
                var salary = $('input[name="salary"]').val();

                customer = { name: name, age: age, salary: salary };

                console.log(customer);
                customersRef.push(customer);

            });

        });
    </script>
</body>
</html>